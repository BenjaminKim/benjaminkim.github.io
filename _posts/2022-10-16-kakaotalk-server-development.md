---
layout: post
categories: essay
image: /assets/img/katalk-more.png
title: 카카오톡 서버 개발의 추억
date: 2022-10-16 16:48:00 +0900
---

**1.** 카톡 서버를 배포할 땐 항상 손이 축축해졌습니다. 너무 긴장해서.  
손에서 물이 뚝뚝 떨어졌을 정도...는 좀 오바고 하여간 땀이 많이 났습니다.  
허벅지를 쓸어서 땀을 딱아내며 배포를 시작했습니다.

그런 배포를 천 번쯤 한 것 같습니다.  
백번 쯤 하고 나니 더 이상 땀은 안 나게 되었지만 몸과 마음은 항상 긴장했습니다.  

지금도 배포가 진행될 때의 떨림이 기억납니다.  
내가 지금 하는 일이 우리나라 모든 사람에게 영향을 끼친다니.  

변경된 모든 코드를 신중히 읽었습니다.  
실수하면 큰일 나니깐.  
그런 경험을 해봤다는 것을 소중히 생각합니다.

**2.** 대용량 서비스를 경험해보지 않은 사람들에겐 이상한 일처럼 들릴겁니다.   

카카오톡은 공지사항 같은 간단한 코드조차 쉽게 만들기 어려웠습니다.  
```ruby
Notice.order(created_at: :desc)
```
이렇게 교과서의 첫 장에 나온대로 코딩하면 서버가 죽기 일쑤였습니다.  
트래픽이 너무 많은 걸.

1초 당 몇 개의 요청이 들어왔는지 지금도 기억합니다.  
모든 DB 앞에는 캐시가 붙어있었고 심지어는 nginx 에서도 캐시를 했습니다.  

지금 다시 생각해보면 좀 웃깁니다.  
아니 공지사항 만드는데 뭐가 그리 복잡해?  
서비스 공지라는 걸 사람들이 읽기나 한다고? 그게 재밌나?  
근데 카카오톡의 공지사항은 재밌었습니다. 저도 매번 공지를 읽으며 감탄하곤 했습니다.  
그 당시에 쓴 공지사항들은 서비스하는 사람들이 다시금 읽어봐야 한다고 생각합니다.  

**3.** 공지사항을 쓰던 공지녀를 존경했습니다.  
그분의 서비스 아이디어와 센스를 보며 많이 배웠습니다.  
언젠가 그분이 이런 말을 했습니다.  
대세인 드라마는 좋든 싫든 본다.  
트렌드를 이해하기 위해서.  
프로란 이런 것이구나 생각했습니다.

[커피한잔](https://withcoffee.app)을 만들고 나서는 바로 공지녀를 찾아가 피드백을 구했습니다.  
값진 조언들을 해주셨습니다. 지금도 고맙게 생각합니다.

**4.** 카톡 더보기에서 새로운 서비스들을 노출해줬습니다.  
빨간 New 뱃지로 사람들의 시선을 끌었습니다.  
빨간 점이 생기면 사람들의 클릭이 몰렸습니다.  
궁금해서 클릭하는 사람도 있고 그냥 빨간 점을 없애기 위해 클릭 하는 사람들도 있었습니다.

![](/assets/img/katalk-more.png)

파트너 서비스 개발자들은 이 빨간 뱃지를 무시하곤 했습니다.  
에이 그깟 빨간 뱃지가 뭐라고. 우리 트래픽 다 받을 수 있어요. 걱정마세요.

걱정말기는.  
빨간 뱃지를 붙여주기만 하면 사람들의 트래픽이 몰렸고 여지없이 서버들이 죽어나갔습니다.  
아이고, 잘 준비하라고 그렇게 일렀건만.  

대용량 트래픽 경험은 이래서 특별하고 소중합니다.

**5.** 선데이토즈의 애니팡이었던걸로 기억합니다.  
애니팡이 히트를 쳐서 대박 났을 때  
어느 날 카톡 개발 서버로 트래픽이 엄청 들어오기 시작했습니다.  

뭐야 뭐야? 무슨 일이야?  
애니팡 개발자들이 프로덕션용 SDK가 아니라 개발용 SDK를 그대로 릴리즈해버린 것입니다.  
와씨 무슨 이런 얼간이들이 다있어?

개발 서버 한 대밖에 없는데 이 서버로 애니팡의 트래픽이 몰려오기 시작했습니다.  
빨리 앱을 다시 올리라고!  
선데이토즈와 긴급하게 연락을 해가면서 어찌어찌 해결했던 것 같습니다.  
이런 미친 이벤트가 거의 매일 있었지만 웃으면서 일할 수 있었습니다.  
장사가 이렇게 잘 되는데 즐겁지 않을리가?

**6.** 장애는 항상 많았습니다.  
이번처럼 하루 종일 카톡이 안되는 전체 장애는 흔치 않았지만 부분 장애는 거의 매일 있었습니다.  
어느날 이런 혼잣말을 했던 것이 기억납니다.  
"아 어째 애니팡 하트 문자보다 장애 알림이 더 많이 오냐."  
2012년 가을에 애니팡 하트 메세지가 우리들을 얼마나 괴롭혔는지 생각해보면 그 때 장애 알림이 얼마나 많이 왔는지 알 수 있습니다.  

서비스를 지키는 동시에 새로운 서비스를 계속 만들어나갔습니다.  
몸은 대부분 긴장 상태로 있었고 신경은 날카로웠습니다.  
핸드폰은 소리로 해놨습니다. 잠을 잘 때는 귀 옆에 대고.

요즘에는 핸드폰을 수면 모드로 해놓은채 잠을 잡니다.  
너무 편안합니다.

**7.** 트래픽 폭탄을 맞아 서버가 멈추는 경험을 처음 하게 되면 패닉이 옵니다.  
머리는 하얘지고 손가락은 굳어서 아무것도 할 수가 없습니다.  
겪여보기 전에는 쉽게 말하지만 한 번 패닉을 경험하면 이게 얼마나 무서운 일인지 알게 됩니다.  

지금도 카톡 동료들이 열심히 장애 복구를 하고 있을 것 같습니다.  
응원을 해주고 싶습니다.  
얼마나 어렵고 무거운 일인지 알고 있기에.  

서비스 장애가 나면 사람들은 두 부류로 나뉩니다.  
서비스의 소중함을 깨닫고 감사하고 응원해주는 사람들.  
서비스 안된다고 조롱하고 비난하는 사람들.

저는 감사하고 응원하며 사는 쪽이 되고 싶습니다. 제 주위에도 이런 사람들이 많았으면 좋겠습니다.