---
layout: post
categories: essay
image: /assets/img/wet_coffee_server.png
title: 커피한잔 서버 장애 썰
date: 2024-05-03 14:32:00 +0900
---

[집에서 서버를 6년 동안 운영](/essay/2024/04/29/home-server.html)했다는 것이 많은 분들에게 신기하게 들렸나 봅니다.  
이해합니다. 옛 개발자 동료들도 이야기를 들으면 대부분 놀랐으니까.

집에서 서버를 운영하는 것을 추천하긴 합니다만...  
모든 일에는 장점과 단점이 있습니다. 한 쪽 이야기만 하고 싶지는 않습니다.  
그동안 집에서 서버를 운영하면서 발생했던 장애들에 대해 말해볼까 합니다.

홈 서버를 운영하는 사람들의 걱정은 다음과 같을 겁니다.  
* 정전되면 어쩌지?
* 인터넷 끊어지면 어쩌지?
* IP 바뀌면 어쩌지?  

자주는 아니지만 이런 일들이 실제로 일어나긴 합니다.  

### 첫 번째 기억 (2018년 멀티탭 실수로 꺼버림) ###
첫 번째로 기억나는 것은 리모컨을 떨어뜨렸을 때입니다.  
에어컨 리모컨을 바닥에 떨어뜨렸는데 하필 컴퓨터의 멀티탭 ON/OFF 스위치에 정통으로 떨어져서 전원이 꺼졌던 순간.  
제가 바로 옆에 있었기 때문에 별일은 아니었습니다만 헛웃음이 나올 정도로 황당했습니다. 😹

컴퓨터야 다시 켜면 되지만 걱정은 듭니다.  
Process가 IO를 하는 도중에 전기가 내려가면 섬뜩할 수 밖에요.  
혹시 DB가 다시 안 올라오면 어쩌지?  
운이 좋아서인지 기술이 좋아져서 인지 다행히도 문제가 된 적은 없었네요.

### 두 번째 기억 (2019년 집 이사) ###
두 번째는 이사 가던 날입니다.  
집에 서버가 있는데 이사를 가야 한다니.  
이사 며칠 전부터 스트레스가 극심했습니다.  
하... 이거 잘 해낼 수 있을까?

이삿짐 아저씨들에게 신신당부를 했습니다.  
저 컴퓨터는 절대 건들지 말라고.  
전원도 뽑지 말고.. 그냥 근처에 가시지 말아달라고. ㅋㅋ  
제가 알아서 옮기겠다고.

공지사항으로 사용자들에게 하루 동안 서비스가 안 된다고 미리 안내하고 준비를 가진 후에...  
컴퓨터만 남겨두고 이삿짐을 다 옮긴 다음, 맨 마지막에 컴퓨터를 셧다운 시키고 제 차에 실어 얼른 이동시켰습니다.

이날이 2019년 제일 더웠던 날인데 아직도 기억에 강렬하게 남아있네요.  
[추억의 공지사항](https://withcoffee.app/notices/20)도 여전히 남아있습니다.

### 세 번째 기억 (2020년 인터넷 이틀 동안 안 됨)
아마 2020년에 비가 많이 왔을 때였을 겁니다.  
갑자기 집에 인터넷이 안 되는 겁니다.

KT에서는 엔지니어가 가서 고쳐주겠다고 하는데... 내일에나 갈 수 있다고.  
헐... 어떻게 그럴 수가.

서비스 돌아가야 하는데 인터넷이 하루 동안 안된다니?

당시 [제가 보유하고 있던 건물의 차고로](https://brunch.co.kr/@buildingking) 컴퓨터를 들고 갔습니다.  
비가 어찌나 많이 오던지... 아내가 컴퓨터를 이불로 감싸줬습니다. ㅋㅋ

다행히 컴퓨터에는 문제가 없으니...  
가서 새로 공유기랑 연결하고 DNS 설정을 변경해서 다시 서비스를 시작했습니다.

집에 인터넷이 고쳐지고 다시 서버를 집으로 가져와야 하는데...  
사람들 다 자는 새벽 4시에 가져왔습니다.

### 네 번째 기억 (2022년 정전) ###
네 번째는 2022년 비가 엄청 왔던 날.  
그 유명한 강남역 전설의 짤이 탄생한 날.

![강남역 침수 서초동 현자](/assets/img/gangnam_flood.png)

이게 웬 비인가 하며 집에서 일찍부터 막걸리를 마시다가 초저녁에 잠이 들었습니다.  
새벽에 잠에서 깼는데... 뭔가 기분이 싸한 것.

핸드폰을 보니 서비스가 안 되고 있었습니다.  
일어나서 방에 가보니 컴퓨터가 꺼져있더라고요.

아침에 아내에게 물어보니 밤 10시쯤 살짝 정전이 있었다고 합니다.  
잠깐 꺼졌다가 곧바로 전기가 다시 들어왔다고.  

결혼 후 8년 동안 아내에게 화를 내거나 목소리를 높인 적이 한 번도 없습니다.  
이날 아주 살짝 뾰로통하게 말했던 것 같습니다.  
정전이 되면 저에게 말 좀 해달라고... ㅋㅋㅋ  
서비스 장애 감지 시 저에게만 메일이 오던 것을 아내도 함께 받도록 개선했습니다.  

### 마지막 장애 (2023년 서버 침수) ###

2022년 강남역 침수로 잠깐 정전이 되어 서비스가 멈췄을 때 사용자분이 달아준 리뷰가 있습니다.

![서버 침수됐나요?](/assets/img/server_flooded.png)

그때는 웃고 넘어간 댓글이었는데... 실제로 그 일이 일어났습니다.  
가족 모두 보름 동안 속초 여행을 가 있는 동안 커피한잔 서버가 침수돼버린 것입니다.

![침수된 커피한잔 서버](/assets/img/wet_coffee_server.png)  
*침수된 커피한잔 서버. 아니, 대체 어쩌다 이런 일이...*

윗집에서 수도관이 터져버린 것.  
불쌍한 제 서버에 물이 잔뜩 쏟아져서 컴퓨터가 멈추고 말았습니다.  
자세한 이야기는 조코딩 유튜브에서 했으니 한 번 들어보시면 재밌을 겁니다.  
서버 이야기가 주가 아니라 1인 개발자가 되고 싶다면 알아야 할 것들에 대해 이야기했습니다.

<div class="iframe-container">
    <iframe src="https://www.youtube.com/embed/Z2VXtzFYd1w" allowfullscreen></iframe>
</div>
<br>
이런 꼴들을 겪고 나면 비용이고 뭐고 걱정이 돼서 얼른 aws로 옮겨야지 싶어집니다.  
저 또한 그랬습니다.

저희 가족은 여행을 아주 많이 다녔는데...  
(일주일짜리 여행을 거의 매달 갔던 것 같습니다.)

여행을 갈 때는 특히나 걱정이 되곤 했습니다.  
집을 비운 동안 무슨 일이 생기진 않겠지?

[커피한잔](https://withcoffee.app/)이 돈을 못 버는 서비스도 아니고...  
이제는 더 이상 서버비를 아낄 때가 아니다 하는 생각을 해왔습니다.  
하지만 생각만 할 뿐 행동으로 옮기기는 어려웠습니다.  
자주 나는 사고도 아니잖아? 돈도 절약될뿐더러... 서비스 중인 서버 옮기려면 얼마나 귀찮고 힘든데.

걱정을 하면서도 손을 못 대고 살았습니다.  
그러다가 정말 일이 터져버리고 말았던 것입니다.  

결국 어쩔 수 없이 aws로 이주를 하게 됐습니다.  
매우 고통스러운 밤이었지만... 옮기고 나니 이제야 속이 편합니다.  
마음 속의 걱정도 많이 사라졌습니다.

서버를 집에서 운영하면 장점은 확실합니다. 비용이 거의 들지 않는다는 것.  
하지만 결국 서비스가 커지면서 조금씩 부담이 생길 수 밖에 없습니다.

시작은 집에서 하되... 적당한 시기에 잘 옮겨가라.  
이게 제가 배운 교훈입니다.

P.S. 유튜브에서 입은 [리바이스 청자켓은 1995년에 비싼 돈을 주고 사서 후회하던 자켓](https://brunch.co.kr/@buildingking/58)입니다.  
30년 동안 안 입고 집에 모셔두고 살았는데... 이제야 돈 값을 한 것 같습니다.(웃음)
<br>
<br>
*함께 읽으면 좋은 글:*
* [집에서 서버를 운영하는 게 가능한가요?](/essay/2024/04/29/home-server.html)
* [카카오톡 서버 개발의 추억](/essay/2022/10/16/kakaotalk-server-development.html)
* [서버 비용을 아끼던 사람들](/essay/2024/03/07/people-saving-cost.html)